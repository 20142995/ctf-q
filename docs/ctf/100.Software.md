[TOC]

# CTF 相关工具

IDA_pro all 链接：https://pan.baidu.com/s/1zEzqYVRNS69UQc7wfmujXw#y7hz 

Acunetix | Web Application Security Scanner

靶场 awd平台 https://github.com/vidar-team/Cardinal
frpc内网穿透工具



## python

https://www.python.org/ftp/python/3.8.1/python-3.8.1.exe
https://www.python.org/ftp/python/3.5.2/python-3.5.2.exe
https://www.python.org/ftp/python/2.7.16/python-2.7.16.msi

## Burpsuit
快捷键  

Ctrl+Space发送请求 | repater中
### 准备文件
top password之类搜索 
常用字典 https://github.com/rootphantomer/Blasting_dictionary

### 使用方法 
可以默认把intercept关闭, 直接用history, 全选包内容, send to repeater

查看端口: proxy-options

拦截记录: proxy-http history
### 无Payload

Payload type: null payload

## Winhex

Q： 怎样粘贴 FFD8 为16进制？
A： Shift+Insert 选ascii-hex。 

### 常用技巧
底部状态栏，会显示偏移位，10进制。
### 快捷键
Ctrl+F时查找时列出更多结果

Ctrl+C 复制
Shift+Ctrl+C 复制16进制

Ctrl+B 粘贴，不进行偏移（菜单编辑-剪贴板数据-写入）

选区域
  Alt+1 右击选块起始
  Alt+2 右击选块结束

dump选区？

点击左侧地址栏，切换10/16进制
### 常用设置 

工具 - 数据解释器， 可以勾选 各种要显示的类型。

在界面上右击数据解释器，可以选 Big Endian。

## 010 Editor

分析 jpg。 打开后按提示install或 菜单: Template - Repository , jpg - install

分析到 char unknownPadding， 使用dd分离。

    dd if=logo.jpg of=2-1.jpg skip=$((0x7011)) bs=1 # 7011是起始地址

或 右击hex窗口中的选中区域，，右击 selection-save selection

insert 切换插入和改写 数据模式

## sublime text 
添加公式

https://stackoverflow.com/questions/57232189/sublime-text-3-markdown-preview-chrome-does-not-render-maths-equation

1.markdownpreview settings
```
{
    "enabled_parsers": ["markdown"],
    "enable_mathjax": true,
    "image_path_conversion": "relative",
    "js": [
    "https://cdn.bootcdn.net/ajax/libs/mathjax/2.7.1/MathJax.js",
            "res://MarkdownPreview/js/math_config.js",
    ],
}

```
2.Install Package Resource Viewer

Package Contol: Install Package -> Package Resource Viewer.

Edit math_config.js

`Package Resource Viewer -> Open Resource -> MarkdownPreview -> js -> math_config.js`
Replace the contents with:

```
MathJax.Hub.Config({
  config: ["MMLorHTML.js"],
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML"],
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true
  },
  TeX: {
    extensions: ["AMSmath.js", "AMSsymbols.js"],
    TagSide: "right",
    TagIndent: ".8em",
    MultLineWidth: "85%",
    equationNumbers: {
      autoNumber: "AMS",
    },
    unicode: {
      fonts: "STIXGeneral,'Arial Unicode MS'"
    }
  },
  displayAlign: "center",
  showProcessingMessages: false,
  messageStyle: 'none'
});
```



## Cyberchef
https://github.com/mattnotmax/cyberchef-recipes

Magic 支持递归解码

- [Decode a Base64-encoded string](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)&input=VTI4Z2JHOXVaeUJoYm1RZ2RHaGhibXR6SUdadmNpQmhiR3dnZEdobElHWnBjMmd1)
- [Convert a date and time to a different time zone](https://gchq.github.io/CyberChef/#recipe=Translate_DateTime_Format('Standard date and time','DD/MM/YYYY HH:mm:ss','UTC','dddd Do MMMM YYYY HH:mm:ss Z z','Australia/Queensland')&input=MTUvMDYvMjAxNSAyMDo0NTowMA)
- [Parse a Teredo IPv6 address](https://gchq.github.io/CyberChef/#recipe=Parse_IPv6_address()&input=MjAwMTowMDAwOjQxMzY6ZTM3ODo4MDAwOjYzYmY6M2ZmZjpmZGQy)
- [Convert data from a hexdump, then decompress](https://gchq.github.io/CyberChef/#recipe=From_Hexdump()Gunzip()&input=MDAwMDAwMDAgIDFmIDhiIDA4IDAwIDEyIGJjIGYzIDU3IDAwIGZmIDBkIGM3IGMxIDA5IDAwIDIwICB8Li4uLi6881cu/y7HwS4uIHwKMDAwMDAwMTAgIDA4IDA1IGQwIDU1IGZlIDA0IDJkIGQzIDA0IDFmIGNhIDhjIDQ0IDIxIDViIGZmICB8Li7QVf4uLdMuLsouRCFb/3wKMDAwMDAwMjAgIDYwIGM3IGQ3IDAzIDE2IGJlIDQwIDFmIDc4IDRhIDNmIDA5IDg5IDBiIDlhIDdkICB8YMfXLi6%2BQC54Sj8uLi4ufXwKMDAwMDAwMzAgIDRlIGM4IDRlIDZkIDA1IDFlIDAxIDhiIDRjIDI0IDAwIDAwIDAwICAgICAgICAgICB8TshObS4uLi5MJC4uLnw)
- [Decrypt and disassemble shellcode](https://gchq.github.io/CyberChef/#recipe=RC4({'option':'UTF8','string':'secret'},'Hex','Hex')Disassemble_x86('64','Full x86 architecture',16,0,true,true)&input=MjFkZGQyNTQwMTYwZWU2NWZlMDc3NzEwM2YyYTM5ZmJlNWJjYjZhYTBhYWJkNDE0ZjkwYzZjYWY1MzEyNzU0YWY3NzRiNzZiM2JiY2QxOTNjYjNkZGZkYmM1YTI2NTMzYTY4NmI1OWI4ZmVkNGQzODBkNDc0NDIwMWFlYzIwNDA1MDcxMzhlMmZlMmIzOTUwNDQ2ZGIzMWQyYmM2MjliZTRkM2YyZWIwMDQzYzI5M2Q3YTVkMjk2MmMwMGZlNmRhMzAwNzJkOGM1YTZiNGZlN2Q4NTlhMDQwZWVhZjI5OTczMzYzMDJmNWEwZWMxOQ)
- <a href="https://gchq.github.io/CyberChef/#recipe=Fork('\\n','\\n',false)From_UNIX_Timestamp('Seconds (s)')&input=OTc4MzQ2ODAwCjEwMTI2NTEyMDAKMTA0NjY5NjQwMAoxMDgxMDg3MjAwCjExMTUzMDUyMDAKMTE0OTYwOTYwMA">Array | Display multiple timestamps as full dates</a>
- [Condition | Carry out different operations on data of different types](https://gchq.github.io/CyberChef/#recipe=Fork('\\n','\\n',false)Conditional_Jump('1',false,'base64',10)To_Hex('Space')Return()Label('base64')To_Base64('A-Za-z0-9%2B/%3D')&input=U29tZSBkYXRhIHdpdGggYSAxIGluIGl0ClNvbWUgZGF0YSB3aXRoIGEgMiBpbiBpdA)
- <a href="https://gchq.github.io/CyberChef/#recipe=Register('key%3D([\\da-f]*)',true,false)Find_/_Replace({'option':'Regex','string':'.*data%3D(.*)'},'$1',true,false,true)RC4({'option':'Hex','string':'$R0'},'Hex','Latin1')&input=aHR0cDovL21hbHdhcmV6LmJpei9iZWFjb24ucGhwP2tleT0wZTkzMmE1YyZkYXRhPThkYjdkNWViZTM4NjYzYTU0ZWNiYjMzNGUzZGIxMQ">Register | Use parts of the input as arguments to operations</a>
- <a href="https://gchq.github.io/CyberChef/#recipe=Register('(.{32})',true,false)Drop_bytes(0,32,false)AES_Decrypt({'option':'Hex','string':'1748e7179bd56570d51fa4ba287cc3e5'},{'option':'Hex','string':'$R0'},'CTR','Hex','Raw',{'option':'Hex','string':''})&input=NTFlMjAxZDQ2MzY5OGVmNWY3MTdmNzFmNWI0NzEyYWYyMGJlNjc0YjNiZmY1M2QzODU0NjM5NmVlNjFkYWFjNDkwOGUzMTljYTNmY2Y3MDg5YmZiNmIzOGVhOTllNzgxZDI2ZTU3N2JhOWRkNmYzMTFhMzk0MjBiODk3OGU5MzAxNGIwNDJkNDQ3MjZjYWVkZjU0MzZlYWY2NTI0MjljMGRmOTRiNTIxNjc2YzdjMmNlODEyMDk3YzI3NzI3M2M3YzcyY2Q4OWFlYzhkOWZiNGEyNzU4NmNjZjZhYTBhZWUyMjRjMzRiYTNiZmRmN2FlYjFkZGQ0Nzc2MjJiOTFlNzJjOWU3MDlhYjYwZjhkYWY3MzFlYzBjYzg1Y2UwZjc0NmZmMTU1NGE1YTNlYzI5MWNhNDBmOWU2MjlhODcyNTkyZDk4OGZkZDgzNDUzNGFiYTc5YzFhZDE2NzY3NjlhN2MwMTBiZjA0NzM5ZWNkYjY1ZDk1MzAyMzcxZDYyOWQ5ZTM3ZTdiNGEzNjFkYTQ2OGYxZWQ1MzU4OTIyZDJlYTc1MmRkMTFjMzY2ZjMwMTdiMTRhYTAxMWQyYWYwM2M0NGY5NTU3OTA5OGExNWUzY2Y5YjQ0ODZmOGZmZTljMjM5ZjM0ZGU3MTUxZjZjYTY1MDBmZTRiODUwYzNmMWMwMmU4MDFjYWYzYTI0NDY0NjE0ZTQyODAxNjE1YjhmZmFhMDdhYzgyNTE0OTNmZmRhN2RlNWRkZjMzNjg4ODBjMmI5NWIwMzBmNDFmOGYxNTA2NmFkZDA3MWE2NmNmNjBlNWY0NmYzYTIzMGQzOTdiNjUyOTYzYTIxYTUzZg">Perform AES decryption, extracting the IV from the beginning of the cipher stream</a>
- [Automagically detect several layers of nested encoding](https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false)&input=V1VhZ3dzaWFlNm1QOGdOdENDTFVGcENwQ0IyNlJtQkRvREQ4UGFjZEFtekF6QlZqa0syUXN0RlhhS2hwQzZpVVM3UkhxWHJKdEZpc29SU2dvSjR3aGptMWFybTg2NHFhTnE0UmNmVW1MSHJjc0FhWmM1VFhDWWlmTmRnUzgzZ0RlZWpHWDQ2Z2FpTXl1QlY2RXNrSHQxc2NnSjg4eDJ0TlNvdFFEd2JHWTFtbUNvYjJBUkdGdkNLWU5xaU45aXBNcTFaVTFtZ2tkYk51R2NiNzZhUnRZV2hDR1VjOGc5M1VKdWRoYjhodHNoZVpud1RwZ3FoeDgzU1ZKU1pYTVhVakpUMnptcEM3dVhXdHVtcW9rYmRTaTg4WXRrV0RBYzFUb291aDJvSDRENGRkbU5LSldVRHBNd21uZ1VtSzE0eHdtb21jY1BRRTloTTE3MkFQblNxd3hkS1ExNzJSa2NBc3lzbm1qNWdHdFJtVk5OaDJzMzU5d3I2bVMyUVJQ)

Base 数字转换
- 10 => 16  -- Base from 16

FlowControl:
   Register 保存数据
   Conditional Jump - 单行控制:  正则匹配 + flow + return(这是非匹配行)
         -- 正则匹配(label:key) + flow + return(这是非匹配行)
         -- label key + flow (匹配行)
Util:
   Drop 删除字符
   Take 保留字符
每行单独执行
   1. fork
   2. 添加执行码

rc4解码 file:///F:/downloads/@CTF/CyberChef_v9.21.0/CyberChef_v9.21.0.html#recipe=RC4(%7B'option':'UTF8','string':'12345678abcdefghijklmnopqrspxyz'%7D,'Hex','Latin1')&input=YmNjNTEyN2Q4NTIzODQ3MTdiMzkyODAyZDM1MWYzMmM4OTJiYTYyY2FmMDk
hex array to char file:///F:/downloads/@CTF/CyberChef_v9.21.0/CyberChef_v9.21.0.html#recipe=Regular_expression('User%20defined','%5C%5Cd%2B',true,true,false,false,false,false,'List%20matches')From_Charcode('Line%20feed',16)&input=MzEgMzIgMzM
每行+3 用subtract `-3` https://gchq.github.io/CyberChef/#recipe=Fork('\\n','\\n',false)Find_/_Replace({'option':'Regex','string':'$'},' -3',true,false,true,false)Subtract('Space')&input=MTIKMTU
```
* 1
find: $
replace: {space}-3
*2
subtract: delimiter space,  , substract -3就= -(-3) = +3
```

hex转数字 - base16, 计算还是用subtract配合使用
求余
```
input: c8
1.From Hex转二进制
2.用and 127 对byte取余

From_Hex('Auto')
AND({'option':'Decimal','string':'127'})

#recipe=From_Hex('Auto')AND(%7B'option':'Decimal','string':'127'%7D)&input=Yzg

```
## Claunch
cmd
文件名 %comspec%
参数  /k doskey ds=python dirsearch.py -w "D:\wgf\My Documents\GitHub\blog\vuepress-starter\docs\ctf\assets\db\dicc.txt" -ephp -u $*


## 网络信息/网络地址

局域网可使用的网段（私网地址段）有三大段：
10.0.0.0~10.255.255.255（A类）
172.16.0.0~172.31.255.255（B类）
192.168.0.0~192.168.255.255（C类）
小技巧：如果你在网络出口上使用NAT技术，使用任何网段都是可以的，比如说1.1.1.1。

### 网卡信息
网卡的GUID在系统中是以文件的形式存在 参考链接：https://www.jaiminton.com/cheatsheet/DFIR/#gather-wifi-passwords

网卡信息存放于C:\ProgramData\Microsoft\Wlansvc\Profiles\Interfaces
