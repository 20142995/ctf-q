题目
```python
import uuid
import libnum
import gmpy2

flag="flag{"+str(uuid.uuid4())+"}"
print(flag)
e = 65537
m = libnum.s2n(flag.encode())
p1 = libnum.generate_prime(128)
q1 = libnum.generate_prime(128)
p2 = libnum.generate_prime(128)
q2 = libnum.generate_prime(128)
print("p1=",p1)
print("q1=",q1)
print("p2=",p2)
print("q2=",q2)
n1=p1*q1
n2=p2*q2
print("n1=",n1)
print("n2=",n2)
c1 = pow(m, e, n1)
c2 = pow(m, e, n2)
print("c1=",c1)
print("c2=",c2)
p1= 241529374856419543994843741620715478233
q1= 329891612475502969315412700917758756573
p2= 179415062328238613586720079938194290751
q2= 281209161331996176661322999324485217597
n1= 79678514931584446837886795964984740987618425126262080131520484181733127175509
n2= 50453159207651801862952938090505477143503284591035016948403490994601319545347
c1= 10906371165492800616190805676717306177005704888515733402096006986355132032250
c2= 47055855052437161522184969745110429012879528443871661682592147046669796586664
```

## 推导

$$
\begin{multline}
\shoveleft
\begin{aligned}
    & c = (mp+n)^e \% n \\
    & c = (mp+n)^e + kn \\
    & c = k_2p+(k_mpn)^e + n^e +  k_1pq \\
    & c\%p = n^e\%p \\
    & kp = n^e -c \\
\end{aligned}
\end{multline}
$$

## exp 
```python
import operator
from functools import reduce

import gmpy2
from Crypto.Util.number import long_to_bytes

p1 = 241529374856419543994843741620715478233
q1 = 329891612475502969315412700917758756573
p2 = 179415062328238613586720079938194290751
q2 = 281209161331996176661322999324485217597
n1 = 79678514931584446837886795964984740987618425126262080131520484181733127175509
n2 = 50453159207651801862952938090505477143503284591035016948403490994601319545347
c1 = 10906371165492800616190805676717306177005704888515733402096006986355132032250
c2 = 47055855052437161522184969745110429012879528443871661682592147046669796586664
e = 65537


def CRT(n, c):
    M = reduce(operator.mul, n)  # m1*m2*...*mn
    sum = 0

    for n, c in zip(n, c):
        Mi = M // n
        mr = gmpy2.invert(Mi, n)
        sum = sum + mr * Mi * c
    return sum % M


cm = CRT([n1, n2], [c1, c2])
nm = n1 * n2
phim = (p1 - 1) * (q1 - 1) * (p2 - 1) * (q2 - 1)
n = n1 * n2
d = gmpy2.invert(e, phim)
m = pow(cm, d, nm)
print(long_to_bytes(m))
```
