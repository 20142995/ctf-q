题目

https://www.bilibili.com/video/BV1of4y1M76t

```
e=65537
(p-1)*(q-1)=15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032
c=13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763
invert(p,q)=63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531
invert(q,p)=61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507
```

$$
\begin{multline}
\shoveleft
\begin{aligned}
    & p^{-1}p=1\% q \\
    & p^{-1}p=1 + kq \\
    & p^{-1}p - 1=k_1q \\
    \\
    & q^{-1}q = 1 \% p \\
    & q^{-1}q = 1 + k_2p \\
    & q^{-1}q - 1=k_2p \\
    & \# 两个式子相乘 \\
    & (p^{-1}p - 1)  (q^{-1}q - 1) = k_2p  k_1q  & \# p  q = n \\
    & (p^{-1}p - 1)  (q^{-1}q - 1) = kn & \\
    & p^{-1}p  q^{-1} q - p^{-1}p - q^{-1}q + 1= kn & \\
    & - p^{-1}p - q^{-1}q + 1= kn - p^{-1}q^{-1} n \\
    & p^{-1}p + q^{-1}q - 1 = p^{-1}q^{-1} n - kn \\
    & p^{-1}p + q^{-1}q - 1 = kn \\
\end{aligned}
\end{multline}
$$

那么k=?, 其实k=1, 测试一下

```
p = getPrime(512)
q = getPrime(512)
n = p*q
p1 = gmpy2.invert(p,q)
q1 = gmpy2.invert(q,p)
print(n.bit_length()) # 1024
print((p1*p+q1*q-1).bit_length()) # 1024
```

那么解方程


$$
\begin{multline}
\shoveleft
\begin{aligned}
   & p^{-1}p + q^{-1}q - 1 = n \\
   & (p-1)(q-1) = phi
\end{aligned}
\end{multline}
$$


exp

```python
import gmpy2
import sympy
from Crypto.Util.number import getPrime, long_to_bytes

e = 65537
phin = 15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032
c = 13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763
p1 = 63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531
q1 = 61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507

p = sympy.symbols('p')
q = sympy.symbols('q')
f1 = p1 * p + q1 * q - 1 - p * q
f2 = (p - 1) * (q - 1) - phin
pq = sympy.solve([f1, f2], [p, q])
p , q = pq[1]
d = gmpy2.invert(e, phin)
m = pow(c,d, int(p*q))
print(long_to_bytes(m))
```

