题目
```py
from Crypto.Util.number import *
from secret import flag,e
m=bytes_to_long(flag)
p=getPrime(64)
q=getPrime(256)
n=p**4*q
k=getPrime(16)
gift=pow(e+114514+p**k,0x10001,p)
c=pow(m,e,n)
print(f'p={p}')
print(f'q={q}')
print(f'c={c}')
print(f'gift={gift}')
"""
p=14213355454944773291
q=61843562051620700386348551175371930486064978441159200765618339743764001033297
c=105002138722466946495936638656038214000043475751639025085255113965088749272461906892586616250264922348192496597986452786281151156436229574065193965422841
gift=9751789326354522940
"""
```

考查幂展开、费⻢⼩定理和域下开⾼次根
通过幂展开和费⻢⼩定理可以得到

$$
(e + 114514)^{65537} ≡ gift (mod p)
$$

求出e后会发现e|phi
这边看到有不少⼈是爆破的e，其实不需要（具体看代码，主要是逆元的知识）。
域下开⾼次根⽐较常⽤的是AMM算法
这⾥也可以⽤集成好的nth_root来完成域下开⾼次根



sage

```py
from Crypto.Util.number import *
from tqdm import tqdm
p=14213355454944773291
q=61843562051620700386348551175371930486064978441159200765618339743764001033297
c=105002138722466946495936638656038214000043475751639025085255113965088749272461906892586616250264922348192496597986452786281151156436229574065193965422841
phi=p^3*(p-1)*(q-1)
gift=9751789326354522940
d1=inverse(0x10001,phi)
e=pow(gift,d1,p)-114514
n=p^4*q
K=Zmod(n)
x=K(c).nth_root(e,all=True)
for i in tqdm(x):
    m=long_to_bytes(int(i))
    if b"hgame" in m:
        print(m)
        break
```

