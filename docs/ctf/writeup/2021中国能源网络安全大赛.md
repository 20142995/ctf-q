https://www.cnblogs.com/twosmi1e/p/15413391.html
https://verf1sh.github.io/2021/10/15/%E8%83%BD%E6%BA%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9Bpwn%E6%96%B9%E5%90%91%E9%A2%98%E8%A7%A3/
https://www.freebuf.com/articles/web/291784.html

# My writeup
[TOC]

# ezphp

### 题目描述

```php
<?php 
if(!$_GET['site']){ 
?>
<html> 
<body> 
想看个二次元怎么这么难
<form action='' method='GET'> 
<input type='submit' name='submit' /> 
<input type='text' name='site' style="width:1000px" value="https://bilibili.com/"/> 
</form>
</body>
</html> 
<?php
    die(); 
}
show_source(__FILE__);

if (($_GET['user']===$_GET['password'])||(md5($_GET['user'])!=md5($_GET['password']))) die();

$url = $_GET['site']; 
$path = $_GET['path'];
$url_schema = parse_url($url); 
$host = $url_schema['host']; 
$request_url = $url."/v/popular/all".$path; 
$res = file_get_contents($request_url);


if (strstr($res,"flag")) die("you can't see my flag");

if($res){ 
    echo "<h1>Source Code:</h1>"; 
    echo $request_url; 
    echo "<hr />"; 
    echo $res; 
}else{ 
    echo "get source failed"; 
} 
?>
```
### 我的解答

点提交按钮后，看到源码.
源码大意为：需要先进行md5绕过，然后$request_url = $url."/v/popular/all".$path；即拼接成地址，然后通过file_get_contents($request_url) 进行echo输出，另有过滤语句对flag进行过滤。
解题思路：通过数组进行md5绕过，通过构造末尾为../../../../../flag进行读取，通过伪协议进行base64加密绕过flag过滤。payload:   ?user[]=1&password[]=2&site=php://filter/read=convert.base64-encode/resource=/../../&path=../../../../../flag
提交后，对显示的值进行base64解密，获得flag

# Crypto
## base
### 题目描述

31332b353d3f3f3f2d2d2d2d7a6d6a74706d3838757366677a6d797474736467746d65697a6c6c74787a6d657a61646a766d6f66757365677262776b7a77666a7a61796f7a646d75373d3d3d

### 我的解答

先进行16进制转字符，看到提示为13+5为18，经过多次尝试，进行rot18转换，生成的值转成大写，再base32解码，获得flag

## rsa
### 题目描述
```
e1=835967807536519622934604405063
c1=19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710
n1=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863
e2=885003184250422219085124964981
c2=4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400
n2=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863
```

### 我的解答

共模攻击

```python
import gmpy2
import libnum


e1=835967807536519622934604405063
c1=19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710
n1=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863
e2=885003184250422219085124964981
c2=4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400
n2=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863


import gmpy2
import binascii

n=n1
s = gmpy2.gcdext(e1,e2)
m1 = gmpy2.powmod(c1,s[1],n)
m2 = gmpy2.powmod(c2,s[2],n)

m = (m1*m2)%n

print(binascii.unhexlify(hex(m)[2:]))
```


# Misc
## hardwire_1
### 题目描述

流量分析

### 我的解答

wireshark 导出 http文件。其中有一些php文件和一个rar的文件。

其中10k的文件，有rar头。。删除头部多余字符修复rar。发现有解压密码。

有个php中base64的部分全部解码。有一个文件中有

```
cmdcd / d "C:\php\htdocs" & winrar a - pf@l#ag102 key.rar key.jpg&echo [S]&cd&echo [E]
```
`winrar -p[密码]` -p后面的是就是密码。

解压后得flag
## fragment

拼图排好顺序
```
1803.png 2977.png 3404.png 4304.png 5996.png 6295.png 7018.png 8520.png 9403.png
```

提取文件

```py
from pathlib import Path

f = open('a.zip', 'wb')

for p in Path('.').glob('*.png'):
    print(p)
    rb = p.read_bytes()
    bend = [0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42, 0x60, 0x82]
    index = rb.find(bytearray(bend))
    rest = rb[index + len(bend):]
    f.write(rest)

f.close()
```
解压后slienteye提取内容

```
b1011010 x78 0155 x68 Wg== b110011 x73 b110000 0117 0124 SQ== x33 b1001110 b1000100 x6b 0171 x4e 0152 VQ== 0172 x4d b1101101 0116 x6b b1001101 0127 Ug== aw== 0115 x57 TQ== x30 b1001110 x6a 0112 0153 b1011010 Rw== x45 0167 x5a RA== b1010010 0154 x4e 0107 x4d Mg== b1011010 x58 060 x3d
```

转一下码。

```py
import base64
t = "b1011010 x78 0155 x68 Wg== b110011 x73 b110000 0117 0124 SQ== x33 b1001110 b1000100 x6b 0171 x4e 0152 VQ== 0172 x4d b1101101 0116 x6b b1001101 0127 Ug== aw== 0115 x57 TQ== x30 b1001110 x6a 0112 0153 b1011010 Rw== x45 0167 x5a RA== b1010010 0154 x4e 0107 x4d Mg== b1011010 x58 060 x3d"
lst = t.split(' ')
for e in lst:
    if e.startswith('b'):
        exec(f'e=0{e}')
        print(chr(e), end='')
    elif e.startswith('x'):
        exec(f'e=0{e}')
        print(chr(e), end='')
    elif e.startswith('0'):
        print(chr(int(e,8)), end='')
    else:
        r = base64.b64decode(e.encode())
        print(r.decode(), end='')
```
得到 `ZxmhZ3s0OTI3NDkyNjUzMmNkMWRkMWM0NjJkZGEwZDRlNGM2ZX0=`


base64解

## APPG

图片左上角一连续黄色奇怪。。
提取Rgb, 蓝色通道为flag。

## wava

010查看有2个RIFF头。。前面的多余，去掉。。然后morse解码。